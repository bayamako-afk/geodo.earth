/* =========================
   GUNO v5 app.css (Base + Layout unified)
   - カードが必ず見える
   - 3面固定：左 dashboard / 右上 slots / 右下 map
   - HTMLは変更不要（.left-col を display:contents で潰す）
   ========================= */

/* ---------- Theme / Size tokens ---------- */
:root{
  /* line colors */
  --jy-color: #00AA00;
  --m-color:  #F62E36;
  --g-color:  #FF9500;
  --t-color:  #009BBF;

  /* layout */
  --gap: 8px;
  --radius: 10px;
  --left: 0.95fr;
  --right: 1.05fr;
  --right-top: 0.52fr;      /* slots */
  --right-bottom: 0.48fr;   /* map */

  /* cards */
  --card-w: clamp(42px, 4.8vw, 90px);
  --card-h: calc(var(--card-w) * 1.5);
  --card-gap: 8px;

  /* backgrounds (css/app.css -> ../assets/...) */
  --bg-jy: url("../assets/cards/bg_JY.png");
  --bg-m:  url("../assets/cards/bg_M.png");
  --bg-g:  url("../assets/cards/bg_G.png");
  --bg-t:  url("../assets/cards/bg_T.png");
}

/* ---------- Global ---------- */
html, body { height: 100%; }
body{
  font-family: "Helvetica Neue", Arial, sans-serif;
  background:#1a1a1a;
  color:#eee;
  margin:0;
  padding:10px;
  box-sizing:border-box;
  overflow:hidden; /* ページスクロール禁止 */
}
.hidden{ display:none !important; }

/* ---------- Panels ---------- */
.panel{
  background:#222;
  border:1px solid #333;
  padding:10px;
  border-radius: var(--radius);
  min-width:0;
  min-height:0;
  overflow:hidden; /* 固定3面の方針 */
}

/* ---------- 3-pane layout ---------- */
/* HTML:
.game-container
  ├ .left-col
  │   ├ .panel-dashboard
  │   └ .panel-slots
  └ .panel-map
*/
.game-container{
  display:grid;
  grid-template-columns: var(--left) var(--right);
  grid-template-rows: var(--right-top) var(--right-bottom);
  gap: var(--gap);
  height: calc(100dvh - 20px); /* body padding分のざっくり補正（必要なら微調整） */
  min-height:0;
}

/* ★これで .left-col の存在をCSS的に消して再配置できる */
.left-col{ display: contents; }

/* left: dashboard (縦貫通) */
.panel-dashboard{
  grid-column: 1;
  grid-row: 1 / 3;
  display:flex;
  flex-direction: column;
  min-height:0;
}
#players-area{
  flex:1;            /* ★空白を潰す */
  min-height:0;
  overflow:hidden;   /* スクロール出したくない方針 */
}

/* right-top: slots */
.panel-slots{
  grid-column: 2;
  grid-row: 1;
  min-height:0;
}
#slots-area{
  display:grid;
  grid-template-columns: 1fr;
  gap:12px;
  min-height:0;
  overflow:hidden;
}

/* right-bottom: map */
.panel-map{
  grid-column: 2;
  grid-row: 2;
  min-height:0;
}
#map{
  width:100%;
  height:100%;
  min-height:200px;
}

/* ---------- Slots / grids ---------- */
.line-header{
  font-weight:900;
  font-size:13px;
  margin:0 0 6px;
  padding:3px 8px;
  border-radius:6px;
  color:#fff;
  text-align:center;
}

.map-grid{
  --cols: 6;
  display:grid;
  gap: var(--card-gap);
  justify-content:center;
  grid-template-columns: repeat(var(--cols), minmax(0, var(--card-w)));
  grid-auto-rows: var(--card-h);
}

/* empty slot */
.slot{
  background:#2a2a2a;
  border:1px solid #3d3d3d;
  border-radius:6px;
  aspect-ratio: 2 / 3;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  color:#fff;
  font-weight:800;
  position:relative;
  overflow:hidden;
}

/* ---------- Card base (これが無いと“見えない”) ---------- */
.card{
  display:inline-block;
  width: var(--card-w);
  height: var(--card-h);
  border-radius:6px;
  background:#fff;
  border:2px solid #666;
  background-size: cover;
  background-repeat:no-repeat;
  background-position:center;
  box-shadow: 0 2px 8px rgba(0,0,0,.35);
  vertical-align: top;
}

.card.playable{
  cursor:pointer;
  border-color:#4CAF50;
  box-shadow: 0 0 14px rgba(76,175,80,.75);
}
.card.unplayable{
  filter: grayscale(100%) brightness(0.5);
  opacity: .55;
}

/* ---------- Overlay card (minimum) ---------- */
.guno-card{
  --w: var(--card-w);
  --h: calc(var(--w) * 88 / 63);

  --line: var(--jy-color);
  --bg: var(--bg-jy);

  position:relative;
  width: var(--w);
  height: var(--h);
  border-radius: calc(var(--w) * 0.06);
  overflow:hidden;

  background-image: var(--bg);
  background-size: cover;
  background-position:center;
  background-repeat:no-repeat;
}

/* line backgrounds */
.guno-card[data-line="JY"]{ --line: var(--jy-color); --bg: var(--bg-jy); }
.guno-card[data-line="M"] { --line: var(--m-color);  --bg: var(--bg-m); }
.guno-card[data-line="G"] { --line: var(--g-color);  --bg: var(--bg-g); }
.guno-card[data-line="T"] { --line: var(--t-color);  --bg: var(--bg-t); }

/* ---------- Mobile tweak ---------- */
@media (max-width: 1023px){
  :root{
    --gap: 6px;
    --left: 1fr;
    --right: 1fr;
    --right-top: 0.50fr;
    --right-bottom: 0.50fr;

    --card-w: clamp(34px, 6vw, 56px);
    --card-gap: 6px;
  }
}